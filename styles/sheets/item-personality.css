/* =========================================================
   性格 (Personality) 物品卡专用样式 - Final Clean Version
   ========================================================= */

/* 1. 窗口配色：水墨羊皮纸风格 */
.xjzl-window.item.personality .window-content {
    background: #f4ecd8 !important;
    /* 暖黄色背景 */
    color: #2c2c2c;
}

/* 2. 头部元素 (Header) */
.xjzl-window.item.personality .xjzl-tag {
    background: #4a0404 !important;
    /* 深红底 */
    color: #f1e5ac !important;
    /* 金字 */
    border: none !important;
}

.xjzl-window.item.personality .xjzl-icon-btn {
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
    width: auto !important;
    height: 30px !important;
    padding: 0 12px !important;
    background: #e8dfc8 !important;
    color: #4a0404 !important;
    border: 1px solid #8b7d6b !important;
    font-size: 0.9rem;
    font-weight: bold;
    white-space: nowrap !important;
    gap: 6px;
}

.xjzl-window.item.personality .xjzl-icon-btn.active {
    background: #4a0404 !important;
    color: #f1e5ac !important;
    border-color: #d4a017 !important;
    box-shadow: 0 0 5px rgba(74, 4, 4, 0.4);
}

/* 3. 富文本编辑器 (ProseMirror) - 终极 Flex 修复 */
/* 必须使用 Flex 垂直布局，防止菜单栏盖住内容 */
.xjzl-window.item.personality prose-mirror {
    display: flex !important;
    flex-direction: column !important;
    min-height: 250px !important;
    background: #ffffff !important;
    border: 1px solid #8b7d6b !important;
    border-radius: 4px;
    padding: 0 !important;
    position: relative;
    overflow: hidden;
    color: #000 !important;
}

/* 菜单栏 (上) */
.xjzl-window.item.personality prose-mirror .editor-menu {
    flex: 0 0 auto !important;
    position: relative !important;
    width: 100%;
    background: #4a0404 !important;
    /* 性格专属深红菜单 */
    color: #eee !important;
    border-bottom: 1px solid #ccc;
    padding: 5px !important;
    margin: 0 !important;
    z-index: 2;
}

/* 内容区 (下) - 自动填充剩余高度 */
.xjzl-window.item.personality prose-mirror .editor-container {
    flex: 1 1 auto !important;
    height: auto !important;
    overflow-y: auto !important;
    background: #ffffff !important;
    padding: 15px !important;
    position: relative;
    z-index: 1;
}

/* 实际文字 */
.xjzl-window.item.personality prose-mirror .editor-content.ProseMirror {
    min-height: 100%;
    color: #000000 !important;
    font-family: "Noto Serif SC", serif;
    line-height: 1.6;
    outline: none;
    white-space: pre-wrap;
}

/* 4. GM 编辑模式 (Pills Layout) */
.xjzl-window.item.personality .editing.xjzl-skills-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    /* 强制三列 */
    gap: 8px;
    background: rgba(0, 0, 0, 0.03);
    padding: 10px;
    border-radius: 4px;
}

.xjzl-window.item.personality .editing .xjzl-skill-pill {
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: 6px 0 !important;
    background: #dcd0b8;
    border: 1px solid #8b7d6b;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: bold;
    color: #4a0404;
    transition: 0.2s;
    white-space: nowrap;
}

/* 选中状态 */
.xjzl-window.item.personality .editing .xjzl-skill-pill.active {
    background: #2e4a2e !important;
    /* 深绿 */
    color: #ffffff !important;
    border-color: #d4a017 !important;
    box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.4);
}

/* 5. 玩家选择模式 (Cards Layout) */
.xjzl-window.item.personality .playing.xjzl-skills-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 12px;
}

.xjzl-window.item.personality .playing .xjzl-skill-card {
    height: 70px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: #eee7d3;
    border: 2px solid #bda886;
    border-radius: 4px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    color: #5a3a2a;
    font-weight: bold;
}

.xjzl-window.item.personality .playing .xjzl-skill-card:hover {
    border-color: #d4a017;
    background: #fffdf5;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

/* 选中状态 */
.xjzl-window.item.personality .playing .xjzl-skill-card.active {
    background: #4a0404 !important;
    /* 深红 */
    color: #f1e5ac !important;
    /* 金字 */
    border: 2px solid #d4a017 !important;
    box-shadow: 0 4px 10px rgba(74, 4, 4, 0.4);
}

.xjzl-window.item.personality .xjzl-skill-marker {
    font-size: 0.7em;
    margin-top: 5px;
    opacity: 0.6;
}