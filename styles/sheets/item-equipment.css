/* styles/sheets/item-equipment.css */

/* =========================================
   1. 局部变量与类型配色 (Type Coloring)
   ========================================= */

/* 默认 / 武器 (Weapon): 锐利寒光 */
.xjzl-window.item.equipment {
  --c-theme-main: #2c3e50;
  /* 深铁灰 */
  --c-theme-light: rgba(44, 62, 80, 0.05);
  --c-theme-border: rgba(44, 62, 80, 0.3);
}

/* 防具 (Armor): 厚重青铜 */
.xjzl-window.item.equipment.type-armor {
  --c-theme-main: #5d4037;
  /* 赭石褐 */
  --c-theme-light: rgba(93, 64, 55, 0.08);
  --c-theme-border: rgba(93, 64, 55, 0.3);
}

/* 奇珍 (Qizhen): 神秘紫金 */
.xjzl-window.item.equipment.type-qizhen {
  --c-theme-main: #6a1b9a;
  /* 绛紫 */
  --c-theme-light: rgba(106, 27, 154, 0.08);
  --c-theme-border: rgba(106, 27, 154, 0.3);
}

/* =========================================
   2. Grid 区域映射 (ApplicationV2)
   ========================================= */
.xjzl-window.item.equipment [data-application-part="header"] {
  grid-column: 1 / 2;
  grid-row: 1 / 2;
}

.xjzl-window.item.equipment [data-application-part="details"],
.xjzl-window.item.equipment [data-application-part="effects"] {
  grid-column: 2 / 3;
  grid-row: 1 / 2;
  height: 100%;
}

.xjzl-window.item.equipment [data-application-part="tabs"] {
  grid-column: 3 / 4;
  grid-row: 1 / 2;
}

/* =========================================
   3. 输入框视觉皮肤 (Visual Skin) - [强力修复]
   ========================================= */

/* 1. 去除黑底 */
.xjzl-window.item.equipment input:not([type="checkbox"]),
.xjzl-window.item.equipment select,
.xjzl-window.item.equipment textarea {
  background: transparent !important;
  background-color: transparent !important;
  border: none !important;
  border-bottom: 1px dashed rgba(0, 0, 0, 0.2) !important;
  border-radius: 2px !important;
  color: var(--c-ink-dark) !important;
  box-shadow: none !important;
  font-family: var(--font-serif);
  transition: all 0.2s;
}

/* 2. 头部大标题 */
.xjzl-window.item.equipment .xjzl-sidebar input[name="name"] {
  font-family: var(--font-title);
  font-size: 28px !important;
  text-align: center;
  border-bottom: 2px solid var(--c-theme-main) !important;
  height: 50px !important;
  margin-bottom: 15px;
  color: var(--c-theme-main) !important;
}

/* 3. 小字段边框色 */
.xjzl-window.item.equipment .xjzl-ink-field {
  border-left-color: var(--c-theme-border) !important;
}

/* 4. 聚焦状态 */
.xjzl-window.item.equipment input:focus,
.xjzl-window.item.equipment select:focus,
.xjzl-window.item.equipment textarea:focus {
  background: #fff !important;
  border-bottom: 1px solid var(--c-theme-main) !important;
  outline: none !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05) !important;
}

/* =========================================
   4. 侧边栏特化 (Sidebar) & 动态品阶 (Ranks)
   ========================================= */

/* --- 基础样式 --- */
.xjzl-window.item.equipment .portrait-wrapper {
  width: 100%;
  max-width: 140px;
  aspect-ratio: 1/1;
  margin: 20px auto;
  border-radius: 4px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  border: 3px solid var(--c-theme-border);
  background: rgba(0, 0, 0, 0.05);
  /* 解决白吃白 */
  overflow: hidden;
  transition: 0.3s;
}

.xjzl-window.item.equipment .portrait-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border: none;
  transform: none;
}

/* --- 品阶配色变量 --- */
.xjzl-window.item.equipment.rank-fan {
  --c-rank: #5f5f5f;
  --c-rank-bg: rgba(0, 0, 0, 0.05);
}

.xjzl-window.item.equipment.rank-tong {
  --c-rank: #b87333;
  --c-rank-bg: rgba(184, 115, 51, 0.1);
}

.xjzl-window.item.equipment.rank-yin {
  --c-rank: #718093;
  --c-rank-bg: rgba(113, 128, 147, 0.1);
}

.xjzl-window.item.equipment.rank-jin {
  --c-rank: #d4af37;
  --c-rank-bg: rgba(212, 175, 55, 0.1);
}

.xjzl-window.item.equipment.rank-yu {
  --c-rank: #2ecc71;
  --c-rank-bg: rgba(46, 204, 113, 0.1);
}

/* --- 应用品阶样式 --- */

/* 1. 头像框 */
.xjzl-window.item.equipment .portrait-wrapper {
  border-color: var(--c-rank) !important;
  background: var(--c-rank-bg) !important;
}

/* 高级特效 */
.xjzl-window.item.equipment.rank-jin .portrait-wrapper,
.xjzl-window.item.equipment.rank-yu .portrait-wrapper {
  box-shadow: 0 0 15px var(--c-rank);
  border-width: 2px;
}

/* 2. 头部标题 */
.xjzl-window.item.equipment .xjzl-sidebar input[name="name"] {
  color: var(--c-rank) !important;
  border-bottom-color: var(--c-rank) !important;
}

/* 3. 导航 Logo */
.xjzl-window.item.equipment .xjzl-nav__logo {
  border-color: var(--c-rank) !important;
  color: var(--c-rank) !important;
  box-shadow: 0 0 10px var(--c-rank-bg) !important;
}

/* 4. 云纹标题 */
.xjzl-window.item.equipment h3 {
  color: var(--c-rank) !important;
}

/* =========================================
   5. 内容区样式
   ========================================= */

/* 标题云纹 */
.xjzl-window.item.equipment h3 {
  font-family: var(--font-title);
  font-size: 26px;
  border-bottom: none !important;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  padding-bottom: 10px;
  margin-top: 10px;
  margin-bottom: 25px;
  color: var(--c-theme-main);
  /* 默认色，会被 rank 覆盖 */
}

.xjzl-window.item.equipment h3::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  max-width: 260px;
  height: 50px;
  background: url('../../assets/ui/header-divider.png') no-repeat center center;
  background-size: 100% 100%;
  opacity: 0.6;
  z-index: -1;
  pointer-events: none;
}

/* 属性 Grid */
.xjzl-window.item.equipment .xjzl-grid-2 {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
}

/* 描述文本域 */
.xjzl-window.item.equipment textarea[name="system.description"] {
  width: 100% !important;
  min-height: 150px;
  background: rgba(0, 0, 0, 0.03) !important;
  border: 1px solid var(--c-theme-border) !important;
  border-radius: 4px;
  padding: 10px;
  color: var(--c-ink-dark);
  font-family: var(--font-serif);
  line-height: 1.6;
  resize: vertical;
}

/* =========================================
   6. 脚本列表美化 (Script List) - [修复作用域]
   ========================================= */
/* [修复] 加上前缀 */
.xjzl-window.item.equipment .xjzl-script-item {
  border: 1px solid var(--c-theme-border) !important;
  background: #fff !important;
  margin-bottom: 10px;
  border-radius: 4px;
  padding: 10px !important;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
}

/* [修复] 加上前缀 */
.xjzl-window.item.equipment .xjzl-script-item .xjzl-input {
  border-bottom: 1px dashed rgba(0, 0, 0, 0.2) !important;
}

/* 脚本编辑器 */
.xjzl-window.item.equipment textarea.script-editor {
  font-family: "Consolas", "Monaco", monospace !important;
  font-size: 12px !important;
  background: rgba(0, 0, 0, 0.03) !important;
  border: 1px solid rgba(0, 0, 0, 0.1) !important;
  min-height: 60px;
  margin-top: 5px;
  color: #333 !important;
}