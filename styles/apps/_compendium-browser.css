/* ==========================================================================
   âš”ï¸ XJZL æ±Ÿæ¹–ä¸‡å·é˜ & æˆ˜åˆ©å“å¡ç‰‡æ ·å¼è¡¨ (V13 ä¿®å¤ç‰ˆ)
   ========================================================================== */

/* ğŸŸ¢ å…¨å±€å˜é‡å®šä¹‰ï¼šé¢œè‰²é…ç½® */
:root {
    /* åŸºç¡€ç•Œé¢è‰² */
    --xjzl-bg-dark: #1a1a1a;
    --xjzl-bg-panel: #181818;
    --xjzl-bg-input: #0f0f0f;
    --xjzl-border: #333;
    --xjzl-text-main: #e0e0e0;
    --xjzl-text-dim: #888;
    --xjzl-primary: #ff6400;
    /* é€‰ä¸­é«˜äº®è‰² */

    /* === ç‰©å“å“è´¨ (Quality) === */
    --xjzl-q-0: #9e9e9e;
    /* å‡¡ (0) - ç°è‰² */
    --xjzl-q-1: #8d6e63;
    /* é“œ (1) - é“œè‰² */
    --xjzl-q-2: #95a5a6;
    /* é“¶ (2) - é“¶äº®è‰² */
    --xjzl-q-3: #ffd700;
    /* é‡‘ (3) - é‡‘è‰² */
    --xjzl-q-4: #00ff7f;
    /* ç‰ (4) - ç¿ ç»¿ */

    /* === æ­¦å­¦/å†…åŠŸå“é˜¶ (Tier) === */
    --xjzl-t-1: #b0bec5;
    /* äººçº§ (1) - è“ç°/å¹³åº¸ */
    --xjzl-t-2: #ffa000;
    /* åœ°çº§ (2) - æ·±æ©™/å“è¶Š */
    --xjzl-t-3: #ff0000;
    /* å¤©çº§ (3) - çº¢è‰²/ä¼ è¯´ (æˆ–è€…ä½ å¯ä»¥æ”¹æˆé‡‘è‰² #d4af37) */
}

/* ==========================================================================
   1. ğŸ“– æµè§ˆå™¨ä¸»çª—å£å¸ƒå±€
   ========================================================================== */

#xjzl-compendium-browser {
    min-width: 950px;
    min-height: 600px;
    background: var(--xjzl-bg-dark);
    color: var(--xjzl-text-main);
    font-size: 13px;
}

#xjzl-compendium-browser .window-content {
    display: grid !important;
    width: 100%;
    height: 100%;
    padding: 0 !important;
    overflow: hidden;

    grid-template-columns: 240px 1fr;
    grid-template-rows: 44px 1fr;
    grid-template-areas:
        "nav nav"
        "sidebar content";
}

/* --- åŒºåŸŸå®šä¹‰ --- */

/* é¡¶éƒ¨å¯¼èˆª */
#xjzl-compendium-browser [data-application-part="navigation"] {
    grid-area: nav;
    background: #222;
    border-bottom: 1px solid #000;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    z-index: 10;
    display: flex;
    align-items: center;
    padding: 0 10px;
    gap: 4px;
}

/* å·¦ä¾§è¾¹æ  */
#xjzl-compendium-browser [data-application-part="sidebar"] {
    grid-area: sidebar;
    background: var(--xjzl-bg-panel);
    border-right: 1px solid var(--xjzl-border);
    box-shadow: inset -5px 0 10px -5px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    padding: 12px;
    gap: 15px;
    overflow-y: auto;
}

/* å³ä¾§å†…å®¹ */
#xjzl-compendium-browser [data-application-part="content"] {
    grid-area: content;
    background: #2b2b2b;
    display: flex;
    flex-direction: column;
    padding: 10px;
    overflow-y: auto;
    position: relative;
}

/* æ»šåŠ¨æ¡ç¾åŒ– */
#xjzl-compendium-browser ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
    background: #111;
}

#xjzl-compendium-browser ::-webkit-scrollbar-thumb {
    background: #444;
    border-radius: 3px;
}

/* ==========================================================================
   2. ğŸ§© ç»„ä»¶æ ·å¼
   ========================================================================== */

/* Tab æŒ‰é’® */
#xjzl-compendium-browser .xjzl-cb-tab-btn {
    background: transparent;
    border: 1px solid transparent;
    color: var(--xjzl-text-dim);
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 6px;
    height: 32px;
    white-space: nowrap;
    transition: all 0.2s;
}

#xjzl-compendium-browser .xjzl-cb-tab-btn:hover {
    color: #ccc;
    background: rgba(255, 255, 255, 0.05);
}

#xjzl-compendium-browser .xjzl-cb-tab-btn.active {
    color: var(--xjzl-primary);
    background: rgba(255, 100, 0, 0.1);
    border-color: rgba(255, 100, 0, 0.2);
}

/* æœç´¢æ¡† */
#xjzl-compendium-browser .xjzl-cb-search-box {
    background: var(--xjzl-bg-input);
    border: 1px solid #444;
    border-radius: 20px;
    padding: 4px 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--xjzl-text-dim);
    flex-shrink: 0;
}

#xjzl-compendium-browser .xjzl-cb-search-box input {
    background: transparent;
    border: none;
    color: #fff;
    flex: 1;
}

#xjzl-compendium-browser .xjzl-cb-search-box input:focus {
    outline: none;
    box-shadow: none;
}

/* ç­›é€‰å™¨ Checkbox */
#xjzl-compendium-browser .filter-title {
    font-size: 0.85em;
    color: #666;
    margin-bottom: 8px;
    font-weight: bold;
}

#xjzl-compendium-browser .checkbox-label {
    display: inline-flex;
    align-items: center;
    background: #2a2a2a;
    color: #999;
    padding: 4px 10px;
    border-radius: 12px;
    border: 1px solid var(--xjzl-border);
    cursor: pointer;
    font-size: 0.85em;
    margin-right: 4px;
    margin-bottom: 4px;
    transition: all 0.1s;
}

#xjzl-compendium-browser .checkbox-label:hover {
    background: #333;
    color: #ccc;
}

#xjzl-compendium-browser .checkbox-label.checked {
    background: var(--xjzl-primary);
    color: #fff;
    border-color: var(--xjzl-primary);
}

#xjzl-compendium-browser .checkbox-label input {
    display: none;
}

/* åº•éƒ¨éšæœºæŒ‰é’® */
#xjzl-compendium-browser .xjzl-cb-sidebar-footer {
    padding-top: 10px;
    border-top: 1px solid var(--xjzl-border);
    margin-top: auto;
}

#xjzl-compendium-browser .random-btn {
    width: 100%;
    background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
    border: 1px solid #4b6cb7;
    color: #fff;
    padding: 8px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
}

/* ==========================================================================
   3. ğŸ´ å¡ç‰‡æ ·å¼ (Grid)
   ========================================================================== */

#xjzl-compendium-browser .xjzl-cb-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
    gap: 8px;
    padding-bottom: 20px;
}

#xjzl-compendium-browser .xjzl-cb-card {
    background: #333;
    border: 1px solid #444;
    border-radius: 4px;
    padding: 6px;
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    height: 48px;
    overflow: hidden;
    transition: transform 0.1s;

    /* é»˜è®¤å·¦è¾¹æ¡†å®½åº¦ (å…·ä½“é¢œè‰²ç”±ä¸‹é¢çš„é€‰æ‹©å™¨å†³å®š) */
    border-left: 4px solid transparent;
}

#xjzl-compendium-browser .xjzl-cb-card:hover {
    background: #3e3e3e;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

#xjzl-compendium-browser .xjzl-cb-card img {
    width: 36px;
    height: 36px;
    border-radius: 4px;
    background: #000;
    object-fit: cover;
    flex-shrink: 0;
}

#xjzl-compendium-browser .xjzl-cb-card-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

#xjzl-compendium-browser .xjzl-cb-card-info .name {
    font-weight: bold;
    color: #ddd;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

#xjzl-compendium-browser .xjzl-cb-card-info .source {
    font-size: 0.75em;
    color: #777;
}

/* 
   ğŸ¨ å¡ç‰‡å·¦ä¾§è¾¹æ¡†å˜è‰²é€»è¾‘ 
   å¿…é¡»é…åˆ HBS ä¸­çš„ data-quality å’Œ data-tier
*/

/* --- æƒ…å†µ A: æ™®é€šç‰©å“ (æ ¹æ® Quality 0-4) --- */
#xjzl-compendium-browser .xjzl-cb-card[data-quality="0"] {
    border-left-color: var(--xjzl-q-0);
}

#xjzl-compendium-browser .xjzl-cb-card[data-quality="1"] {
    border-left-color: var(--xjzl-q-1);
}

#xjzl-compendium-browser .xjzl-cb-card[data-quality="2"] {
    border-left-color: var(--xjzl-q-2);
}

#xjzl-compendium-browser .xjzl-cb-card[data-quality="3"] {
    border-left-color: var(--xjzl-q-3);
}

#xjzl-compendium-browser .xjzl-cb-card[data-quality="4"] {
    border-left-color: var(--xjzl-q-4);
}

/* --- æƒ…å†µ B: æ­¦å­¦/å†…åŠŸ (æ ¹æ® Tier 1-3ï¼Œè¦†ç›– Quality) --- */
/* æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨äº† data-type å±æ€§é€‰æ‹©å™¨æ¥æé«˜ä¼˜å…ˆçº§ */
#xjzl-compendium-browser .xjzl-cb-card[data-type="wuxue"][data-tier="1"],
#xjzl-compendium-browser .xjzl-cb-card[data-type="neigong"][data-tier="1"] {
    border-left-color: var(--xjzl-t-1);
}

#xjzl-compendium-browser .xjzl-cb-card[data-type="wuxue"][data-tier="2"],
#xjzl-compendium-browser .xjzl-cb-card[data-type="neigong"][data-tier="2"] {
    border-left-color: var(--xjzl-t-2);
}

#xjzl-compendium-browser .xjzl-cb-card[data-type="wuxue"][data-tier="3"],
#xjzl-compendium-browser .xjzl-cb-card[data-type="neigong"][data-tier="3"] {
    border-left-color: var(--xjzl-t-3);
    /* å¤©çº§æ­¦å­¦æ–‡å­—ä¹Ÿå¯ä»¥å˜è‰²ï¼Œå¯é€‰ */
    /* background: linear-gradient(90deg, #333, #4a2c2c); */
}


/* ==========================================================================
   4. ğŸ’¬ æˆ˜åˆ©å“å¡ç‰‡ (Chat Log)
   ========================================================================== */

.xjzl-chat-card .loot-list {
    padding: 5px 0;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.loot-item {
    display: flex;
    align-items: center;
    gap: 10px;
    background: rgba(255, 255, 255, 0.5);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    padding: 6px;
    transition: all 0.2s;
    cursor: grab;
    border-left: 4px solid transparent;
}

.loot-item:hover {
    background: #fff;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.loot-item img.item-img {
    width: 32px;
    height: 32px;
    border-radius: 4px;
    object-fit: cover;
    flex-shrink: 0;
}

.loot-item .item-info {
    flex: 1;
    overflow: hidden;
    line-height: 1.3;
}

.loot-item .item-name {
    font-weight: bold;
    font-size: 14px;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.loot-item .item-meta {
    font-size: 11px;
    color: #888;
}

/* èŠå¤©å¡ç‰‡é…è‰²æ˜ å°„ (JS ç”Ÿæˆçš„ class) */
.loot-item.quality-0 {
    border-left-color: var(--xjzl-q-0);
}

.loot-item.quality-1 {
    border-left-color: var(--xjzl-q-1);
}

.loot-item.quality-2 {
    border-left-color: var(--xjzl-q-2);
}

.loot-item.quality-3 {
    border-left-color: var(--xjzl-q-3);
}

.loot-item.quality-4 {
    border-left-color: var(--xjzl-q-4);
}

/* æ­¦å­¦ Chat Card é…è‰² */
.loot-item.tier-1 {
    border-left-color: var(--xjzl-t-1);
}

.loot-item.tier-2 {
    border-left-color: var(--xjzl-t-2);
}

.loot-item.tier-3 {
    border-left-color: var(--xjzl-t-3);
}