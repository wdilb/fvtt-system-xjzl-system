<div class="xjzl-chat-card">
    <div class="card-content-wrapper" style="text-align: center;">

        {{!-- 1. 投掷详情 --}}
        <div class="roll-header" style="pointer-events: none;">
            {{!-- Label: 显示原本的加值说明 --}}
            <div class="label">{{localize "XJZL.UI.Chat.DefendResult.BonusInfo" kanpo=kanpoBase bonus=bonus}}</div>

            {{!-- Value: 修复 - 加回了被删掉的"Total"说明，作为鼠标悬停提示(title)，避免破坏数字布局 --}}
            <div class="value" title="{{localize 'XJZL.UI.Chat.DefendResult.Total'}}">{{defTotal}}</div>

            {{!-- Formula: 显示骰子公式 --}}
            <div class="formula">{{{rollDisplay}}}</div>
        </div>

        {{!-- 修复: 恢复原本的分割线，让上下两部分视觉更清晰 --}}
        <hr style="border-color:#ccc; opacity:0.5; margin: 8px 0;">

        {{!-- 2. 结果判定 --}}
        <div style="margin-top: 15px; font-size:1.2em; font-weight:bold; padding: 5px; border-radius: 4px; 
            {{#if isBroken}} color:#b22222; background:rgba(255,0,0,0.1); border:1px solid #b22222;
            {{else}} color:#228b22; background:rgba(0,255,0,0.1); border:1px solid #228b22; {{/if}}">

            {{#if isBroken}}
            <i class="fas fa-heart-broken"></i> {{localize "XJZL.UI.Chat.DefendResult.Broken"}}
            {{else}}
            <i class="fas fa-shield-alt"></i> {{localize "XJZL.UI.Chat.DefendResult.Resisted"}}
            {{/if}}
        </div>

        {{!-- 提示文字 --}}
        <div style="font-size:0.8em; color:#666; margin-top:5px;">
            {{#if isBroken}}
            {{localize "XJZL.UI.Chat.DefendResult.BrokenHint"}}
            {{else}}
            {{localize "XJZL.UI.Chat.DefendResult.ResistedHint"}}
            {{/if}}
        </div>
    </div>
</div>