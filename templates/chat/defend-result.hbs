<div class="xjzl-chat-card">
    {{!-- 1. 投掷详情区域 --}}
    <div style="text-align:center; padding:8px; background:rgba(0,0,0,0.05); border-radius:4px; border:1px solid #ddd;">
        
        {{!-- 骰子部分 (使用三个大括号解析 HTML) --}}
        <div style="font-size: 1em; color: #333;">
            {{{rollDisplay}}}
        </div>

        {{!-- 加值部分 --}}
        <div style="font-size: 0.85em; color: #666; margin-top: 4px;">
            {{localize "XJZL.UI.Chat.DefendResult.BonusInfo" kanpo=kanpoBase bonus=bonus}}
        </div>

        {{!-- 总值 --}}
        <div style="border-top:1px solid #ccc; margin-top:6px; padding-top:4px;">
            {{localize "XJZL.UI.Chat.DefendResult.Total"}}: <span style="font-size:1.6em; font-weight:900; color:var(--xjzl-ink-800); vertical-align:middle;">{{defTotal}}</span>
        </div>
    </div>

    <hr style="border-color:#ccc; opacity:0.5; margin: 8px 0;">

    {{!-- 2. 结果判定 --}}
    <div style="font-size:1.2em; font-weight:bold; text-align:center; padding: 4px; border-radius: 4px; 
        {{#if isBroken}}
            color:#b22222; background:rgba(255,0,0,0.1); border:1px solid #b22222;
        {{else}}
            color:#228b22; background:rgba(0,255,0,0.1); border:1px solid #228b22;
        {{/if}}">
        
        {{#if isBroken}}
            <i class="fas fa-heart-broken"></i> {{localize "XJZL.UI.Chat.DefendResult.Broken"}}
            <div style="font-size:0.6em; font-weight:normal; margin-top:2px;">{{localize "XJZL.UI.Chat.DefendResult.BrokenHint"}}</div>
        {{else}}
            <i class="fas fa-shield-alt"></i> {{localize "XJZL.UI.Chat.DefendResult.Resisted"}}
            <div style="font-size:0.6em; font-weight:normal; margin-top:2px;">{{localize "XJZL.UI.Chat.DefendResult.ResistedHint"}}</div>
        {{/if}}
    </div>
</div>