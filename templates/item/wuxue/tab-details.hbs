<section class="tab scroll-area {{#if (eq tabs.primary 'details')}}active{{/if}}" 
         data-tab="details" data-group="primary">

    {{!-- 招式列表 --}}
    <div class="xjzl-flex-col">
        {{#each system.moves as |move i|}}
        <div class="xjzl-card" style="position: relative;">
            
            {{!-- 卡片标题栏：图标 + 名字 + 删除 --}}
            <div class="xjzl-flex-row" style="border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 5px;">
                <img src="{{move.img}}" width="24" height="24" style="border:1px solid #000; background:#333;"/>
                <input type="text" name="system.moves.{{i}}.name" value="{{move.name}}" class="xjzl-input" style="font-weight:bold; text-align:left; flex:1;"/>
                
                {{!-- 类型选择 --}}
                <select name="system.moves.{{i}}.type" class="xjzl-input" style="width: 60px;">
                    {{selectOptions ../choices.moveTypes selected=move.type}}
                </select>
                
                {{!-- 删除按钮 --}}
                <a data-action="deleteMove" data-id="{{move.id}}" style="color:#999;"><i class="fas fa-trash"></i></a>
            </div>

            {{!-- 招式详情 (Grid) --}}
            <div class="xjzl-grid-2">
                {{!-- 左列：属性 --}}
                <div class="xjzl-flex-col">
                    <div class="xjzl-flex-row">
                        <label>五行</label>
                        <select name="system.moves.{{i}}.element" class="xjzl-input">
                            {{selectOptions ../choices.elements selected=move.element}}
                        </select>
                    </div>
                    <div class="xjzl-flex-row">
                        <label>消耗</label>
                        <input type="text" name="system.moves.{{i}}.actionCost" value="{{move.actionCost}}" class="xjzl-input"/>
                    </div>
                </div>

                {{!-- 右列：伤害公式 --}}
                <div class="xjzl-flex-col" style="border-left:1px dashed #ccc; padding-left:5px;">
                    <label style="font-size:0.8em; font-weight:bold;">伤害/数值配置</label>
                    <div class="xjzl-flex-row">
                        <label>基础</label>
                        <input type="number" name="system.moves.{{i}}.calculation.base" value="{{move.calculation.base}}" class="xjzl-input"/>
                    </div>
                    {{!-- 这里先简化，未来可以展开更多配置 --}}
                </div>
            </div>
            
            {{!-- 描述 --}}
            <div style="margin-top: 5px;">
                {{!-- 注意：AppV2 的 prose-mirror 需要特定写法，这里先用 textarea 代替 --}}
                <textarea name="system.moves.{{i}}.description" rows="2" class="xjzl-input" style="text-align:left; width:100%; height:auto;" placeholder="招式描述...">{{move.description}}</textarea>
            </div>

        </div>
        {{/each}}

        <button type="button" data-action="addMove" style="margin-top:10px;">
            <i class="fas fa-plus"></i> 添加新招式
        </button>
    </div>

</section>