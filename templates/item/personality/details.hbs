<section class="xjzl-details-container flexcol">
    {{!-- 描述区块 --}}
    <div class="xjzl-section">
        <div class="xjzl-section-header">
            <i class="fas fa-pen-nib"></i> {{localize "XJZL.Personality.Description"}}
        </div>
        {{editor system.description target="system.description" button=true owner=owner editable=editable}}
    </div>

    {{!-- 勾选区块 --}}
    <div class="xjzl-section">
        <div class="xjzl-section-header">
            <i class="fas fa-check-double"></i>
            {{#if isEditing}}{{localize "XJZL.Personality.Options"}}{{else}}{{localize
            "XJZL.Personality.Chosen"}}{{/if}}
            <span class="xjzl-badge">{{#if
                isEditing}}{{system.options.length}}/5{{else}}{{system.chosen.length}}/2{{/if}}</span>
        </div>

        {{#if isEditing}}
        {{!-- GM 编辑模式：全技能选择 --}}
        <div class="xjzl-skills-grid editing">
            {{#each allSkills as |label key|}}
            <label class="xjzl-skill-pill {{#if (includes ../system.options key)}}active{{/if}}">
                <input type="checkbox" data-action="manageOption" data-skill="{{key}}" {{checked (includes
                    ../system.options key)}}>
                {{localize label}}
            </label>
            {{/each}}
        </div>
        {{else}}
        {{!-- 玩家选择模式：磁贴式点击 --}}
        <div class="xjzl-skills-grid playing">
            {{#each availableOptions as |opt|}}
            <div class="xjzl-skill-card {{#if opt.selected}}active{{/if}}" data-action="toggleChoice"
                data-skill="{{opt.key}}">
                <span class="xjzl-skill-name">{{localize opt.label}}</span>
                <div class="xjzl-skill-marker"><i class="fas fa-yin-yang"></i></div>
            </div>
            {{else}}
            <p class="xjzl-empty-hint">尚未配置备选技能池，请联系 GM。</p>
            {{/each}}
        </div>
        {{/if}}
    </div>
</section>