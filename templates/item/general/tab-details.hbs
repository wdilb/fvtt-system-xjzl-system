<section class="tab scroll-area {{#if (eq tabs.primary 'details')}}active{{/if}}" data-tab="details"
    data-group="primary">

    <div class="xjzl-flex-col">

        {{!-- 1. 消耗品配置 --}}
        {{#if isConsumable}}
        <fieldset class="xjzl-card">
            <legend class="xjzl-card-header">消耗品属性</legend>
            <div class="xjzl-flex-col">
                <div class="xjzl-flex-row">
                    <label>{{localize "XJZL.Consumable.TypeLabel"}}</label>
                    <select name="system.type" class="xjzl-input">
                        {{selectOptions consumableTypes selected=system.type}}
                    </select>
                </div>
                <hr style="border-color:#ccc; margin:5px 0;">
                <label style="font-weight:bold;">{{localize "XJZL.Consumable.Recovery"}}</label>
                <div class="xjzl-grid-3">
                    <div class="xjzl-flex-col xjzl-center">
                        <label>{{localize "XJZL.Resources.HP"}}</label>
                        <input type="number" name="system.recovery.hp" value="{{system.recovery.hp}}"
                            class="xjzl-input" />
                    </div>
                    <div class="xjzl-flex-col xjzl-center">
                        <label>{{localize "XJZL.Resources.MP"}}</label>
                        <input type="number" name="system.recovery.mp" value="{{system.recovery.mp}}"
                            class="xjzl-input" />
                    </div>
                    <div class="xjzl-flex-col xjzl-center">
                        <label>{{localize "XJZL.Resources.Rage"}}</label>
                        <input type="number" name="system.recovery.rage" value="{{system.recovery.rage}}"
                            class="xjzl-input" />
                    </div>
                </div>
            </div>
        </fieldset>
        <div class="xjzl-card" style="margin-top:10px;">
            <label style="font-weight:bold;">{{localize "XJZL.Consumable.Script"}}</label>
            <textarea name="system.usageScript" rows="2" class="xjzl-input script-editor"
                placeholder="// 使用后执行的特殊逻辑...">{{system.usageScript}}</textarea>
        </div>
        {{/if}}

        {{!-- 2. 秘籍配置 --}}
        {{#if isManual}}
        <fieldset class="xjzl-card">
            <legend class="xjzl-card-header">秘籍内容</legend>
            <div class="xjzl-flex-col">

                <label>{{localize "XJZL.Manual.TargetItem"}}</label>

                {{!-- 拖拽区域 --}}
                <div class="manual-drop-zone"
                    style="border: 2px dashed #999; border-radius: 6px; padding: 10px; text-align: center; background: rgba(0,0,0,0.05); cursor: pointer;">

                    {{#if system.learnItemUuid}}
                    <div style="font-weight: bold; color: var(--xjzl-accent); font-size: 1.2em;">
                        <i class="fas fa-book"></i> {{targetItemName}}
                    </div>
                    <div style="font-size: 0.8em; color: #666; margin-top: 4px;">UUID: {{system.learnItemUuid}}</div>
                    {{else}}
                    <div style="color: #888;">
                        <i class="fas fa-file-import" style="font-size: 2em; margin-bottom: 5px;"></i><br>
                        请将【内功】或【武学】拖拽至此
                    </div>
                    {{/if}}

                    {{!-- 隐藏的输入框，用于存储数据 --}}
                    <input type="text" name="system.learnItemUuid" value="{{system.learnItemUuid}}"
                        style="display:none;" />
                </div>

                <div class="xjzl-flex-row" style="margin-top:10px;">
                    <label>{{localize "XJZL.Manual.Destroy"}}</label>
                    <input type="checkbox" name="system.destroyOnUse" {{checked system.destroyOnUse}} />
                </div>
            </div>
        </fieldset>
        {{/if}}

        {{!-- 3. 通用描述 --}}
        <div class="xjzl-card" style="margin-top: 15px;">
            <label style="font-weight:bold;">{{localize "XJZL.Equipment.Description"}}</label>
            <textarea name="system.description" rows="5" class="xjzl-input"
                style="text-align:left; height:auto;">{{system.description}}</textarea>
        </div>

        {{!-- 自动化说明 --}}
        <div class="form-group">
            <label style="font-weight:bold; color:#2c3e50;">
                <i class="fas fa-robot"></i> {{localize "XJZL.AutomationNote"}}
            </label>
            <div class="form-fields">
                <input type="text" name="system.automationNote" value="{{system.automationNote}}" class="xjzl-input"
                    placeholder="{{localize 'XJZL.AutomationNotePlaceholder'}}"
                    title="{{localize 'XJZL.AutomationNoteHint'}}"
                    style="background: rgba(0,0,0,0.02); border-bottom: 1px dashed #ccc;" />
            </div>
        </div>

    </div>
</section>