{{!-- templates/actor/character/tab-bio.hbs --}}
<section class="tab scroll-area {{#if (eq tabs.primary 'bio')}}active{{/if}}" data-tab="bio"
    data-group="primary">

    <div class="xjzl-bg-deco">侠</div>

    {{!-- 1. 基础体貌 --}}
    <div class="section-title-row">
        <span class="title-text">{{localize "XJZL.Info.Appearance"}}</span>
        <span class="title-line"></span>
    </div>

    <div class="bio-grid-top">
        <div class="bio-physique-box">
            <div class="xjzl-ink-field">
                <label>{{localize "XJZL.Info.Age"}}</label>
                <input type="number" name="system.info.age" value="{{system.info.age}}">
            </div>
            <div class="xjzl-ink-field">
                <label>{{localize "XJZL.Info.Height"}}</label>
                <input type="text" name="system.info.height" value="{{system.info.height}}">
            </div>
            <div class="xjzl-ink-field">
                <label>{{localize "XJZL.Info.Weight"}}</label>
                <input type="text" name="system.info.weight" value="{{system.info.weight}}">
            </div>
        </div>

        <div class="bio-hobbies-box">
            <label class="box-label">{{localize "XJZL.Info.Hobbies"}} (选3项)</label>
            <div class="hobbies-inputs">
                {{#each hobbySlots as |slot|}}
                <select name="system.info.shihao.{{slot.index}}">
                    {{selectOptions @root.choices.hobbies selected=slot.value blank="-" localize=true}}
                </select>
                {{/each}}
            </div>
        </div>
    </div>

    <div class="xjzl-ink-field full-width" style="margin-top: 10px;">
        <label>{{localize "XJZL.Info.Appearance"}}</label>
        <textarea name="system.info.appearance" rows="2">{{system.info.appearance}}</textarea>
    </div>

    <div class="spacer-block"></div>

    {{!-- 2. 江湖声望与业障 --}}
    <div class="section-title-row">
        <span class="title-text">{{localize "XJZL.Social.Label"}}</span>
        <span class="title-line"></span>
    </div>

    <div class="bio-grid-middle">

        {{!-- A. 声望 --}}
        <div class="bio-card">
            <div class="card-header">{{localize "XJZL.Social.Label"}}</div>
            <div class="card-body">
                <div class="rep-row">
                    <span class="rep-label">{{localize "XJZL.Social.Chaoting"}}</span>
                    <div class="rep-inputs">
                        <div class="xjzl-ink-field compact">
                            <label>{{localize "XJZL.Social.RepChaoting"}}</label>
                            <input type="number" name="system.social.rep_chaoting"
                                value="{{system.social.rep_chaoting}}">
                        </div>
                        <div class="xjzl-ink-field compact">
                            <label>{{localize "XJZL.Social.Attitude.Label"}}</label>
                            <select name="system.social.attitude_chaoting">
                                {{selectOptions choices.attitudes selected=system.social.attitude_chaoting
                                localize=true}}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="rep-row">
                    <span class="rep-label">{{localize "XJZL.Social.Wulin"}}</span>
                    <div class="rep-inputs">
                        <div class="xjzl-ink-field compact">
                            <label>{{localize "XJZL.Social.RepWulin"}}</label>
                            <input type="number" name="system.social.rep_wulin" value="{{system.social.rep_wulin}}">
                        </div>
                        <div class="xjzl-ink-field compact">
                            <label>{{localize "XJZL.Social.Attitude.Label"}}</label>
                            <select name="system.social.attitude_wulin">
                                {{selectOptions choices.attitudes selected=system.social.attitude_wulin localize=true}}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="rep-row">
                    <span class="rep-label">{{localize "XJZL.Social.Shisu"}}</span>
                    <div class="rep-inputs">
                        <div class="xjzl-ink-field compact full">
                            <label>{{localize "XJZL.Social.Attitude.Label"}}</label>
                            <select name="system.social.attitude_shisu">
                                {{selectOptions choices.attitudes selected=system.social.attitude_shisu localize=true}}
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {{!-- B. 业障 --}}
        <div class="bio-card">
            <div class="card-header">{{localize "XJZL.Social.Karma"}}</div>
            <div class="card-body grid-2col">
                <div class="xjzl-seal-box small">
                    <label>{{localize "XJZL.Social.Xiayi"}}</label>
                    <input type="number" name="system.social.xiayi" value="{{system.social.xiayi}}"
                        style="color:var(--c-mp-blue);">
                </div>
                <div class="xjzl-seal-box small">
                    <label>{{localize "XJZL.Social.Exing"}}</label>
                    <input type="number" name="system.social.exing" value="{{system.social.exing}}"
                        style="color:var(--c-cinnabar);">
                </div>
                <div class="xjzl-seal-box small">
                    <label>{{localize "XJZL.Resources.Shalu"}}</label>
                    <div class="split-val">
                        <input type="number" name="system.resources.shalu.value"
                            value="{{system.resources.shalu.value}}">
                        <span class="sep">/</span>
                        <span class="max">100</span>
                    </div>
                </div>
                <div class="xjzl-seal-box small">
                    <label>{{localize "XJZL.Resources.Shanie"}}</label>
                    <input type="number" name="system.resources.shanie" value="{{system.resources.shanie}}"
                        style="color:#555;">
                </div>
                <div class="xjzl-seal-box small">
                    <label>{{localize "XJZL.Resources.Satiety"}}</label>
                    <div class="split-val">
                        <input type="number" name="system.resources.satiety.value"
                            value="{{system.resources.satiety.value}}">
                        <span class="sep">/</span>
                        <span class="max">{{system.resources.satiety.max}}</span>
                    </div>
                </div>
                <div class="xjzl-seal-box small">
                    <label>{{localize "XJZL.Resources.Alcohol"}}</label>
                    <div class="split-val">
                        <input type="number" name="system.resources.alcohol.value"
                            value="{{system.resources.alcohol.value}}">
                        <span class="sep">/</span>
                        <span class="max">{{system.resources.alcohol.max}}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="spacer-block"></div>

    {{!-- 3. 人物传记 --}}
    <div class="section-title-row">
        <span class="title-text">{{localize "XJZL.Info.Bio"}}</span>
        <span class="title-line"></span>
    </div>

    <div class="bio-editor-container">
        <prose-mirror name="system.info.bio" data-document-u-u-i-d="{{document.uuid}}" value="{{system.info.bio}}">
            {{{system.info.bio}}}
        </prose-mirror>
    </div>

    {{!-- 4. 人际关系 --}}
    <div class="section-title-row" style="margin-top: 30px;">
        <span class="title-text">{{localize "XJZL.Social.Relations"}}</span>
        <span class="title-line"></span>
        <a class="xjzl-btn-seal small" data-action="addRelation">
            <i class="fas fa-plus"></i> {{localize "XJZL.Social.AddRelation"}}
        </a>
    </div>

    {{#if system.social.relations.length}}
    <div class="relations-list">
        {{#each system.social.relations as |rel i|}}
        <div class="relation-row">
            {{!-- 姓名 --}}
            <input type="text" name="system.social.relations.{{i}}.name" value="{{rel.name}}"
                placeholder="{{localize 'XJZL.Social.RelationName'}}" class="rel-name">

            {{!-- 关系类型改为 Input --}}
            <input type="text" name="system.social.relations.{{i}}.type" value="{{rel.type}}"
                placeholder="{{localize 'XJZL.Social.RelationTypePlaceholder'}}" class="rel-type">

            {{!-- 数值 --}}
            <input type="number" name="system.social.relations.{{i}}.value" value="{{rel.value}}" placeholder="0"
                class="rel-val">

            {{!-- 删除 --}}
            <a data-action="deleteRelation" data-index="{{i}}" class="delete-rel"><i class="fas fa-trash"></i></a>
        </div>
        {{/each}}
    </div>
    {{else}}
    <div class="empty-arts-hint">{{localize "XJZL.Social.None"}}</div>
    {{/if}}

</section>