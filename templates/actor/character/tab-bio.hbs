<section class="tab scroll-area {{#if (eq tabs.primary 'effects')}}active{{/if}}" data-tab="effects"
    data-group="primary">

    <div class="xjzl-flex-col">

        {{!-- 1. 临时状态 (Buff/Debuff) --}}
        <div class="xjzl-card">
            <div class="xjzl-card-header" style="background: #ffe4e1; color: #8b0000 !important;">临时状态 (Buff / Debuff)
            </div>
            <p style="font-size: 0.8em; color: #666; text-align: center; margin: 0 0 5px 0;">来自 招式特效 或 消耗品，可手动移除。</p>

            {{#each temporaryEffects as |effect|}}
            <div class="xjzl-card neigong-item"
                style="flex-direction: row; align-items: center; padding: 5px; background: rgba(30,30,30,0.9); margin-bottom: 5px; min-height: auto;">

                {{!-- 给图片加一个固定大小的容器 --}}
                <div
                    style="flex: 0 0 32px; height: 32px; width: 32px; border: 1px solid #666; border-radius: 4px; overflow: hidden; background: #000;">
                    <img src="{{effect.img}}" title="{{effect.name}}" />
                </div>

                <div class="xjzl-flex-col xjzl-grow" style="margin-left: 10px; gap: 0;">
                    <span style="font-weight: bold; color: #fff;">{{effect.name}}</span>
                    <span style="font-size: 0.8em; color: #aaa;">来源: {{effect.sourceName}}</span>
                </div>

                {{!-- 删除按钮 --}}
                <a data-action="deleteEffect" data-id="{{effect.id}}" title="移除此状态"
                    style="color: #ff4444; font-size: 1.2em; padding: 5px; cursor: pointer;">
                    <i class="fas fa-times-circle"></i>
                </a>
            </div>
            {{else}}
            <div style="text-align: center; color: #999; padding: 10px;">无临时状态</div>
            {{/each}}
        </div>

        {{!-- 2. 被动属性 (装备/内功) --}}
        <div class="xjzl-card" style="margin-top: 10px; opacity: 0.8;">
            <div class="xjzl-card-header" style="background: #e6e6fa; color: #483d8b !important;">被动属性 (装备/内功)</div>
            <p style="font-size: 0.8em; color: #666; text-align: center; margin: 0 0 5px 0;">来自 装备 或 内功，无法在此移除，请卸下装备。
            </p>

            {{#each passiveEffects as |effect|}}
            <div class="xjzl-flex-row" style="padding: 4px 0; border-bottom: 1px dashed #ccc;">

                {{!-- 同样的图片容器处理 --}}
                <div
                    style="flex: 0 0 24px; height: 24px; width: 24px; border: 1px solid #999; border-radius: 2px; overflow: hidden;">
                    <img src="{{effect.img}}" title="{{effect.name}}" />
                </div>

                <span style="font-weight: bold; color: #333;">{{effect.name}}</span>
                <span style="margin-left: auto; font-size: 0.8em; color: #666;">{{effect.sourceName}}</span>
            </div>
            {{else}}
            <div style="text-align: center; color: #999; padding: 10px;">无被动属性</div>
            {{/each}}
        </div>

    </div>
</section>