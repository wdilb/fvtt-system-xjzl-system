<section class="tab scroll-area {{#if (eq tabs.primary 'skills')}}active{{/if}}" data-tab="skills" data-group="primary">

    {{!-- Grid 布局 --}}
    <div class="xjzl-grid-2">

        {{!-- 循环 1：遍历分组 --}}
        {{#each skillGroups as |group|}}
        <div class="xjzl-card">
            {{!-- A. 属性标题 (点击投属性检定，如 力量检定) --}}
            {{!-- 添加 rollable 类，绑定 key --}}
            <div class="xjzl-card-header rollable" data-action="rollAttribute" data-key="{{group.key}}"
                title="点击进行 {{localize group.label}} 检定">
                {{localize group.label}}
            </div>

            {{!-- 技能列表 --}}
            <div class="xjzl-flex-col" style="gap: 5px;">

                {{!-- 循环 2：遍历具体技能 Key --}}
                {{#each group.skills as |skillKey|}}
                <div
                    style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px dashed rgba(0,0,0,0.1); padding: 4px 0;">

                    {{!-- B. 技能名 (点击投技能检定) --}}
                    <a class="rollable" data-action="rollAttribute" data-key="{{skillKey}}"
                        style="font-weight: bold; color: #333;">
                        {{localize (concat "XJZL.Skills." (capitalize skillKey))}}
                    </a>

                    {{!-- 技能值 --}}
                    <span style="font-size: 1.2em; font-weight: 900; color: var(--xjzl-ink-800);">
                        {{#with (lookup (lookup ../../system.skills skillKey) 'total') as |val|}}
                        {{val}}
                        {{else}}
                        0
                        {{/with}}
                    </span>
                </div>
                {{/each}}
            </div>
        </div>
        {{/each}}

        {{!-- ========================== --}}
        {{!-- 技艺卡片 (Arts) --}}
        {{!-- ========================== --}}
        <div class="xjzl-card" style="grid-column: 1 / -1;">
            <div class="xjzl-card-header">{{localize "XJZL.Arts.Label"}}</div>

            {{!-- 内部 3 列布局 --}}
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 5px;">

                {{#each artsList as |art|}}
                <div class="art-row">

                    {{!-- 左侧容器：名称 + 身份徽章 --}}
                    <div class="art-info">
                        {{!-- C. 技艺名称 (点击投技艺检定) --}}
                        <a class="rollable art-name" data-action="rollAttribute" data-key="{{art.key}}">
                            {{localize art.label}}
                        </a>

                        {{!-- 身份徽章 (仅当存在时显示) --}}
                        {{#if art.identity}}
                        <span class="identity-badge" data-tooltip="{{art.identity.tooltip}}"
                            data-tooltip-class="xjzl-tooltip">
                            {{art.identity.title}}
                        </span>
                        {{/if}}
                    </div>

                    {{!-- 右侧：技艺等级 --}}
                    <span class="art-level">
                        {{art.total}}
                    </span>
                </div>
                {{/each}}

            </div>
        </div>

    </div>
</section>